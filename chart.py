import json
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
import argparse

parser = argparse.ArgumentParser(description="Gmail MCP Server")
parser.add_argument("--filename", "-f", required=True,
                    help="Path to the results file generated by main.py")
args = parser.parse_args()

# Load the results from JSON using the filename from stdin
filename = args.filename
with open(filename, "r") as json_file:
    output_dict = json.load(json_file)

max_digits = output_dict["max_digits"]
min_digits = output_dict["min_digits"]

# Build the accuracy matrix from the JSON data
accuracy_matrix = np.zeros((max_digits, max_digits))
for i in range(min_digits, max_digits + 1):
    for j in range(min_digits, max_digits + 1):
        accuracy_matrix[i - 1, j -
                        1] = output_dict["accuracy_matrix"][str(i)][str(j)]

# Plot the heatmap
plt.figure(figsize=(10, 8))
labels = list(range(min_digits, max_digits + 1))
sns.heatmap(
    accuracy_matrix,
    annot=True,
    fmt=".0f",
    xticklabels=labels,
    yticklabels=labels,
    cmap="RdYlGn",
    vmin=0,
    vmax=100,
)
plt.title("Accuracy of Multiplication by Digit Length")
plt.xlabel("Digits in Number 2")
plt.ylabel("Digits in Number 1")
plt.tight_layout()
plt.show()
